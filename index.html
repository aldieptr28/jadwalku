<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Manajemen Konten</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }

        .sidebar {
            height: 100%;
            width: 250px;
            position: fixed;
            top: 0;
            left: 0;
            background-color: #343a40;
            padding-top: 20px;
            transition: 0.3s;
            overflow-y: auto;
        }

        .sidebar a {
            padding: 10px 15px;
            text-decoration: none;
            font-size: 18px;
            color: white;
            display: block;
            transition: 0.3s;
        }

        .sidebar a:hover {
            background-color: #575757;
        }

        .sidebar .close-btn {
            position: absolute;
            top: 10px;
            right: 25px;
            font-size: 36px;
            margin-left: 50px;
            cursor: pointer;
        }

        .open-btn {
            font-size: 18px;
            cursor: pointer;
            background-color: #343a40;
            color: white;
            padding: 10px 15px;
            border: none;
        }

        #main-content {
            margin-left: 250px;
            transition: margin-left 0.3s;
            padding: 20px;
        }

        .content-container {
            display: none;
        }

        .content-container.active {
            display: block;
        }

        .btn {
            margin-top: 10px;
        }

        table {
            width: 100%;
        }

        td,
        th {
            text-align: center;
            vertical-align: middle;
        }

        @media (max-width: 768px) {
            #main-content {
                margin-left: 0;
            }

            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }

            .sidebar a {
                float: left;
                text-align: center;
                width: 100%;
            }

            .sidebar .close-btn {
                position: relative;
                top: 0;
                right: 0;
            }
        }

        @media (max-width: 576px) {
            .sidebar {
                position: static;
                width: 100%;
                height: auto;
                padding-top: 10px;
            }

            #main-content {
                margin-left: 0;
                padding: 10px;
            }

            h1 {
                font-size: 24px;
            }

            .btn {
                font-size: 14px;
            }

            table,
            th,
            td {
                font-size: 12px;
                padding: 5px;
            }

            .sidebar a {
                padding: 8px 10px;
                font-size: 16px;
            }

            .open-btn {
                padding: 8px 10px;
                font-size: 16px;
            }
        }
    </style>
</head>

<body>
    <div id="mySidebar" class="sidebar">
        <span class="close-btn" onclick="closeNav()">&times;</span>
        <a href="javascript:void(0)" onclick="showContent('schedule')">Jadwal Rutinitas Harian</a>
        <a href="javascript:void(0)" onclick="showContent('tasks')">Tugas Kuliah</a>
        <a href="javascript:void(0)" onclick="showContent('shopping')">Daftar Belanja</a>
        <hr>
        <h5 class="text-light pl-3">Konten Tambahan</h5>
        <div id="additionalContentLinks"></div>
        <button class="btn btn-primary btn-sm" onclick="addNewContent()">Tambah Konten</button>
    </div>

    <div id="main-content">
        <button class="open-btn" onclick="openNav()">&#9776; Menu</button>

        <div id="schedule" class="content-container active">
            <h1 class="text-center mt-4">Jadwal Rutinitas Harian</h1>
            <div class="row mt-5">
                <div class="col-md-10 offset-md-1">
                    <button class="btn btn-primary mb-3" onclick="addNewRow('schedule-table')">Tambah Baris</button>
                    <button class="btn btn-secondary mb-3" onclick="addNewColumn('schedule-table')">Tambah Kolom</button>
                    <table class="table table-bordered table-striped">
                        <thead class="thead-dark">
                            <tr>
                                <th>Waktu</th>
                                <th>Kegiatan</th>
                                <th>Rincian</th>
                                <th>Selesai</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="schedule-table">
                            <!-- Isi konten akan diisi di sini -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="tasks" class="content-container">
            <h1 class="text-center mt-4">Tugas Kuliah</h1>
            <div class="row mt-5">
                <div class="col-md-10 offset-md-1">
                    <button class="btn btn-primary mb-3" onclick="addNewRow('tasks-table')">Tambah Baris</button>
                    <button class="btn btn-secondary mb-3" onclick="addNewColumn('tasks-table')">Tambah Kolom</button>
                    <table class="table table-bordered table-striped">
                        <thead class="thead-dark">
                            <tr>
                                <th>Tugas</th>
                                <th>Keterangan</th>
                                <th>Selesai</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="tasks-table">
                            <!-- Isi konten akan diisi di sini -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="shopping" class="content-container">
            <h1 class="text-center mt-4">Daftar Belanja</h1>
            <div class="row mt-5">
                <div class="col-md-10 offset-md-1">
                    <button class="btn btn-primary mb-3" onclick="addNewRow('shopping-table')">Tambah Baris</button>
                    <button class="btn btn-secondary mb-3" onclick="addNewColumn('shopping-table')">Tambah Kolom</button>
                    <table class="table table-bordered table-striped">
                        <thead class="thead-dark">
                            <tr>
                                <th>Barang</th>
                                <th>Keterangan</th>
                                <th>Selesai</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="shopping-table">
                            <!-- Isi konten akan diisi di sini -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>

    <!-- jQuery, Popper.js, and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        function openNav() {
            document.getElementById("mySidebar").style.width = "250px";
            document.getElementById("main-content").style.marginLeft = "250px";
        }

        function closeNav() {
            document.getElementById("mySidebar").style.width = "0";
            document.getElementById("main-content").style.marginLeft = "0";
        }

        function showContent(contentId) {
            const contents = document.querySelectorAll('.content-container');
            contents.forEach(content => content.classList.remove('active'));
            document.getElementById(contentId).classList.add('active');
        }

        function addNewRow(tableId) {
            const tableBody = document.getElementById(tableId);
            const row = document.createElement('tr');
            const columns = tableBody.parentElement.querySelectorAll('thead th').length - 2; // Minus "Selesai" dan "Aksi"
            
            for (let i = 0; i < columns; i++) {
                const cell = document.createElement('td');
                cell.contentEditable = "true";
                row.appendChild(cell);
            }

            const doneCell = document.createElement('td');
            doneCell.classList.add("checkbox-column");
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.classList.add("form-check-input");
            doneCell.appendChild(checkbox);
            row.appendChild(doneCell);

            const actionsCell = document.createElement("td");
            const deleteButton = document.createElement("button");
            deleteButton.textContent = "Hapus";
            deleteButton.classList.add("btn", "btn-danger", "btn-sm");
            deleteButton.onclick = function () {
                row.remove();
                saveContent();
            };
            actionsCell.appendChild(deleteButton);
            row.appendChild(actionsCell);

            tableBody.appendChild(row);
            saveContent();
        }

        function addNewColumn(tableId) {
            const table = document.getElementById(tableId).parentElement;
            const th = document.createElement('th');
            th.contentEditable = "true";
            th.textContent = `Kolom ${table.querySelectorAll('th').length - 1}`;
            table.querySelector('thead tr').insertBefore(th, table.querySelector('th:nth-last-child(3)'));

            const rows = table.querySelectorAll('tbody tr');
            rows.forEach(row => {
                const td = document.createElement('td');
                td.contentEditable = "true";
                row.insertBefore(td, row.querySelector('td:nth-last-child(3)'));
            });

            saveContent();
        }

        function addNewContent() {
            const contentName = prompt("Masukkan nama konten baru:");
            if (contentName) {
                const link = document.createElement("a");
                link.href = "javascript:void(0)";
                link.onclick = function () { showContent(contentName); };
                link.textContent = contentName;
                document.getElementById("additionalContentLinks").appendChild(link);

                const newContent = document.createElement("div");
                newContent.id = contentName;
                newContent.classList.add("content-container");
                newContent.innerHTML = `<h1 class="text-center mt-4">${contentName}</h1>
                <div class="row mt-5">
                    <div class="col-md-10 offset-md-1">
                        <button class="btn btn-primary mb-3" onclick="addNewRow('${contentName}-table')">Tambah Baris</button>
                        <button class="btn btn-secondary mb-3" onclick="addNewColumn('${contentName}-table')">Tambah Kolom</button>
                        <button class="btn btn-danger mb-3" onclick="removeContent('${contentName}')">Hapus Konten</button>
                        <table class="table table-bordered table-striped">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Kolom 1</th>
                                    <th>Kolom 2</th>
                                    <th>Kolom 3</th>
                                    <th>Selesai</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="${contentName}-table"></tbody>
                        </table>
                    </div>
                </div>`;
                document.getElementById("main-content").appendChild(newContent);
                saveContent();
            }
        }

        function removeContent(contentName) {
            if (confirm("Anda yakin ingin menghapus konten ini?")) {
                document.getElementById(contentName).remove();
                document.querySelector(`a[href="javascript:void(0)"][onclick="showContent('${contentName}')"]`).remove();
                saveContent();
            }
        }

        function saveContent() {
            const contents = [];
            document.querySelectorAll('.content-container').forEach(container => {
                const contentData = {
                    id: container.id,
                    columns: [],
                    tableRows: []
                };
                container.querySelectorAll('thead th').forEach((th, index) => {
                    if (index < container.querySelectorAll('thead th').length - 2) {
                        contentData.columns.push(th.textContent);
                    }
                });
                container.querySelectorAll('tbody tr').forEach(row => {
                    const rowData = {
                        columns: [],
                        done: row.querySelector('.checkbox-column input').checked
                    };
                    row.querySelectorAll('td').forEach((cell, index) => {
                        if (index < row.querySelectorAll('td').length - 2) {
                            rowData.columns.push(cell.textContent);
                        }
                    });
                    contentData.tableRows.push(rowData);
                });
                contents.push(contentData);
            });
            localStorage.setItem('contentData', JSON.stringify(contents));

            const additionalLinks = [];
            document.querySelectorAll('#additionalContentLinks a').forEach(link => {
                additionalLinks.push(link.outerHTML);
            });
            localStorage.setItem('additionalLinks', JSON.stringify(additionalLinks));
        }

        function loadContent() {
            const savedContent = JSON.parse(localStorage.getItem('contentData')) || [];
            const savedLinks = JSON.parse(localStorage.getItem('additionalLinks')) || [];

            savedLinks.forEach(link => {
                document.getElementById('additionalContentLinks').innerHTML += link;
            });

            savedContent.forEach(contentData => {
                const newContent = document.createElement('div');
                newContent.id = contentData.id;
                newContent.classList.add('content-container');
                newContent.innerHTML = `<h1 class="text-center mt-4">${contentData.id}</h1>
                <div class="row mt-5">
                    <div class="col-md-10 offset-md-1">
                        <button class="btn btn-primary mb-3" onclick="addNewRow('${contentData.id}-table')">Tambah Baris</button>
                        <button class="btn btn-secondary mb-3" onclick="addNewColumn('${contentData.id}-table')">Tambah Kolom</button>
                        <button class="btn btn-danger mb-3" onclick="removeContent('${contentData.id}')">Hapus Konten</button>
                        <table class="table table-bordered table-striped">
                            <thead class="thead-dark">
                                <tr>${contentData.columns.map(col => `<th>${col}</th>`).join('')}
                                    <th>Selesai</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="${contentData.id}-table"></tbody>
                        </table>
                    </div>
                </div>`;
                document.getElementById('main-content').appendChild(newContent);

                const tableBody = document.getElementById(`${contentData.id}-table`);
                contentData.tableRows.forEach(rowData => {
                    const row = document.createElement('tr');
                    rowData.columns.forEach(columnData => {
                        const cell = document.createElement('td');
                        cell.contentEditable = "true";
                        cell.textContent = columnData;
                        row.appendChild(cell);
                    });
                    const doneCell = document.createElement('td');
                    doneCell.classList.add('checkbox-column');
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.classList.add('form-check-input');
                    checkbox.checked = rowData.done;
                    doneCell.appendChild(checkbox);
                    row.appendChild(doneCell);

                    const actionsCell = document.createElement('td');
                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = 'Hapus';
                    deleteButton.classList.add('btn', 'btn-danger', 'btn-sm');
                    deleteButton.onclick = function () {
                        row.remove();
                        saveContent();
                    };
                    actionsCell.appendChild(deleteButton);
                    row.appendChild(actionsCell);

                    tableBody.appendChild(row);
                });
            });
        }

        window.onload = loadContent;
        window.onbeforeunload = saveContent;
    </script>
</body>

</html>
